$SoftwareName = "tools"

$vCenters = @(
	'vCenter01'
	'vCenter02'
	'vCenter03'
)

workflow Get-VISoftwareVersion
{
param(
  [Parameter (Mandatory = $true)]
  [string]$vCenter
)
Connect-VIServer $vCenter
$vmhosts = Get-VMHost | Sort-Object $_.name
foreach -Parallel ($vmhost in $vmhosts){
$output = InlineScript {write-host $vmhost.name}
inlinescript {
$esxcli = Get-EsxCli –VMHost (Get-VMHost $vmhost) –V2
$esxcli.software.vib.list.invoke() | Where-Object {$_.Name -like "*tools*"} | fl Name,Version
}
}
}

foreach ($vCenter in $vCenters){
Get-VISoftwareVersion $vCenter
}
